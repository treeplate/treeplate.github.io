<!DOCTYPE html>
<html>
<head>
<title>Hi hi</title>
<style>
  body {width: 25%;}
  .button {border: 10px ridge red}
  .circle { border-radius: 50px; background-color: #4286f4; width: 16px;}
</style>
</head>
<body>
  <p>Things that are framed red(css: "border: 10px ridge red") are buttons.<br>That circle reloads most things</p> 
  <div class = "circle" id = "O"><p>O</p></div>
  <h1 id = "h_one" class = "button">Welcome to Hi Hi</h1>
  <form id = "text">
    <input id = "txtd" type="text" name="text">
    <button id="btn" type="button">SEND</button>
    <!--><button id="clr" type="button">CLEAR</button></!-->
  </form>
  <p>Hi</p>
  <div id = "chat"></div>
  <script>
  var button = document.getElementById("btn");
    var buttwo = document.getElementById("clr");
  var createEl = function(text, type){
            var El = document.createElement(type);
            El.innerHTML = text;
            return El;
        };
var addClass = function(className, classer){
            classer.className += ' ' + className;
        }
        var setClass = function(className, classer){
            classer.className = className;
        }
     var addBackground = function(element, color){
            element.style.backgroundColor = color;
        };
    var userMessages = [[], []];
    var messagesSent = localStorage.length;
    var send = function(){
    localStorage.setItem(messagesSent, document.getElementById("txtd").value);
    messagesSent += 1;
    }
    var reload = function(){
      addBackground(document.getElementById("h_one"), "#ffffff");}
    var click_one = function(){
      addBackground(document.getElementById("h_one"), "#25b244");
    }
    function clearBox(elementID)
{
    document.getElementById(elementID).innerHTML = "";
}
    var shouldUpdate = function(current){
      if (userMessages[0].length == current[0].length){
            var continueq = true;
            for(var i in userMessages[0]){
              if (current[0][i] != userMessages[0][i]){
                return false;
                continueq = false;
              }
            }
            if (continueq){
              for(var i in userMessages[1]){
                if (current[1][i] != userMessages[1][i]){
                  return false;
                  continueq = false;
                }
              }
            }
            if (continueq){return true;}
      } else {
        return false;
      }
    }
    var curMessages = [[], []];
    var message = function(){
      userMessages = [[], []];
      for(i = 0; i < localStorage.length; i++){
        userMessages[0].push("all");
        userMessages[1].push(localStorage.getItem(i));
      }
      var div = document.getElementById("chat");
      if (shouldUpdate(curMessages)){
        console.log("Updating...")
        clearBox("chat");
        curMessages = [[], []];
         
        for (var i = 0;i < userMessages[1].length; i++){
          console.log("HI");
          
          div.append(createEl(userMessages[0][i], h2));
          div.append(createEl(userMessages[1][i], p));
          
          curMessages[0].push(userMessages[0][i]);
          curMessages[1].push(userMessages[1][i]);
        }
      }
      console.log("Updated. " + div.children);
      requestAnimationFrame(message);
    }
    h_one.addEventListener("click", click_one);
    O.addEventListener("click", reload);
    button.addEventListener("click", send);
    buttwo.addEventListener("click", function(){/*userMessages = [[], []];*/localStorage.clear();});
    message();
  </script>
  <a href="index.html">Home</a>
</body>
</html>
